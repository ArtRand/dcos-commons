name: "data-store"
pods:
  meta-data:
    count: 2
    container:
      # in our construct 'networks' represents the container-specific CNI interface
      networks:
        # name of the overlay network, should have a check to make sure it exists in the DCOS cluster
        dcos: {
          name: "mynet",
          port-mappings:
            { host-ports: "4040",
            container-ports: "8080" }
        }
    tasks:
      meta-data-task:
        goal: RUNNING
        cmd: "echo $TASK_NAME >> $TASK_NAME$CONTAINER_PATH_SUFFIX/output && sleep $SLEEP_DURATION"
        cpus: 0.1
        memory: 512
        ports:
          http:
            port: 8080
        volume:
          path: "meta-data-container-path"
          type: ROOT
          size: 5000
        env:
          TASK_NAME: "meta-data"
          CONTAINER_PATH_SUFFIX: "-container-path"
          SLEEP_DURATION: "1000"
  # same as above with more multiple CNI host/container port mappings
  meta-data-multimap:
    count: 2
    container:
      networks:
        dcos: {
          name: "mynet",
          port-mappings:
            { host-ports: "4040,4041",
            container-ports: "8080,8081" }
        }
    tasks:
      meta-data-task:
        goal: RUNNING
        cmd: "echo $TASK_NAME >> $TASK_NAME$CONTAINER_PATH_SUFFIX/output && sleep $SLEEP_DURATION"
        cpus: 0.1
        memory: 512
        ports:
          http:
            port: 8080
        volume:
          path: "meta-data-container-path"
          type: ROOT
          size: 5000
        env:
          TASK_NAME: "meta-data"
          CONTAINER_PATH_SUFFIX: "-container-path"
          SLEEP_DURATION: "1000"
